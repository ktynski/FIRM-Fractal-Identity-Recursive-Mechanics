<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ex Nihilo Reality — Mathematics that compiles</title>
  <link rel="stylesheet" href="assets/site.css" />
</head>
<body>
  <header class="header">
    <div class="brand"><a href="index.html">Ex Nihilo Reality</a></div>
    <nav class="nav">
      <a href="index.html">Home</a>
      <button id="eli25Toggle" class="nav-eli25">ELI25</button>
      <a href="article.html">Article</a>
      <a href="for_the_skeptics.html">For the Skeptics</a>
      <a href="roadmap.html">Roadmap</a>
      <a href="#gallery">Gallery</a>
      <a href="FIGURE_GALLERY.md">All Figures</a>
      <a href="https://github.com/ktynski/FIRM-Fractal-Identity-Recursive-Mechanics" target="_blank" rel="noopener">GitHub</a>
    </nav>
    <button class="hamburger-menu" aria-label="Open navigation menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </header>

  <main>
    <div id="eli25Modal" class="modal" style="display: none;">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Explain It Like I'm 25</h2>
        <p>Imagine you're building with LEGOs, but instead of a manual, you have a single, powerful rule. That rule is "φ" (phi, the golden ratio).</p>
        <p><strong>The Core Idea:</strong> This project, FIRM, proposes that the fundamental "rules" of the universe (the physical constants, like the speed of light or the charge of an electron) aren't random. They are the most stable, most perfect structures that can emerge from this single "φ" rule. It's like finding the most stable LEGO castle you can build—it has a specific, mathematically determined shape.</p>
        <p><strong>What We Do:</strong> We don't guess or try to fit the numbers. We start with pure mathematics (our "φ" rule) and build, step-by-step, to derive the values of these constants. The fact that our derived values are incredibly close to what scientists measure in the real world suggests our "φ" rule is on the right track.</p>
        <p><strong>Why It Matters:</strong> If we're right, it means the universe has a deep, underlying mathematical elegance. We could potentially understand *why* the universe is the way it is, not just *what* it is. It's a shift from describing the universe to truly understanding its blueprint.</p>
      </div>
    </div>
    <section class="hero">
      <div class="card article-preview">
        <h1>
          <span data-technical="FIRM (Fractal Identity & Recursive Mechanics)">FIRM (Fractal Identity & Recursive Mechanics)</span>
          <span data-layperson="We Cracked the Universe's Code">We Cracked the Universe's Code</span>
        </h1>
        
        <div class="insight">
          <span data-technical="FIRM proposes a systematic mathematical framework for deriving fundamental physical constants through φ-recursive principles. Our approach achieves notable precision improvements, particularly for the fine structure constant, though independent validation remains essential for verification.">FIRM proposes a systematic mathematical framework for deriving fundamental physical constants through φ-recursive principles. Our approach achieves notable precision improvements, particularly for the fine structure constant, though independent validation remains essential for verification.</span>
          <span data-layperson="We discovered that the universe's fundamental rules aren't random numbers—they're mathematical patterns based on the golden ratio φ. Think of it like finding the secret recipe that nature uses to build everything from atoms to galaxies.">We discovered that the universe's fundamental rules aren't random numbers—they're mathematical patterns based on the golden ratio φ. Think of it like finding the secret recipe that nature uses to build everything from atoms to galaxies.</span>
        </div>

        <div class="key-result">
          <div class="key-equation">
            α⁻¹ = 137 + φ⁻⁶ ≈ 137.05573<br/>
            <em>Fine structure constant: 0.014% deviation from experiment</em>
          </div>
          <span data-technical="The fine structure constant derivation achieves 0.014% agreement with experimental values, representing significant improvement over previous φ-based formulations. This precision emerges from systematic φ⁻ⁿ optimization within Grace operator theory.">The fine structure constant derivation achieves 0.014% agreement with experimental values, representing significant improvement over previous φ-based formulations. This precision emerges from systematic φ⁻ⁿ optimization within Grace operator theory.</span>
          <span data-layperson="We predicted a fundamental constant of nature to within 0.014% accuracy—that's like hitting a target the size of a penny from 2 miles away. This isn't luck; it's mathematics revealing the universe's blueprint.">We predicted a fundamental constant of nature to within 0.014% accuracy—that's like hitting a target the size of a penny from 2 miles away. This isn't luck; it's mathematics revealing the universe's blueprint.</span>
        </div>

        <div class="hero-buttons">
          <a class="cta" href="article.html">Read Full Article</a>
          <a class="cta secondary" href="#gallery">View the Gallery</a>
        </div>
      </div>
      
      <div class="card">
        <h3>
          <span data-technical="Mathematical Framework">Mathematical Framework</span>
          <span data-layperson="How It Works">How It Works</span>
        </h3>
        <div>
          <span data-technical="Axiomatic Foundation: FIRM theory develops formal countermodel proofs for the independence of five foundational axioms (AG1-AG4, AΨ1). This addresses mathematical rigor requirements, though the physical interpretation remains under development."><strong>Axiomatic Foundation:</strong> FIRM theory develops formal countermodel proofs for the independence of five foundational axioms (AG1-AG4, AΨ1). This addresses mathematical rigor requirements, though the physical interpretation remains under development.</span>
          <span data-layperson="The Big Idea: Instead of measuring constants and asking 'why these numbers?', we start with pure math and show why these specific numbers MUST exist. It's like proving why a circle must have π—inevitable, not accidental."><strong>The Big Idea:</strong> Instead of measuring constants and asking 'why these numbers?', we start with pure math and show why these specific numbers MUST exist. It's like proving why a circle must have π—inevitable, not accidental.</span>
        </div>
        <div class="axiom-foundations">
          <div class="axiom-item">
            <button class="axiom-header">
              <span data-technical="AG1 (Totality): Stratified Grothendieck universe hierarchy"><strong>AG1 (Totality):</strong> Stratified Grothendieck universe hierarchy</span>
              <span data-layperson="Everything Connects: All mathematical structures form one unified system"><strong>Everything Connects:</strong> All mathematical structures form one unified system</span>
            </button>
            <div class="axiom-content">
              <div data-technical="Every morphism ψ: Ψₙ₋₁ → Ψₙ has a corresponding grace morphism g: Ψₙ → Ψₙ₋₁ such that g ∘ ψ preserves essential structure. This establishes the existence of stabilizing operators and provides the foundation for recursive identity preservation within stratified universe hierarchies.">
                <p><strong>Statement:</strong> Every morphism ψ: Ψₙ₋₁ → Ψₙ has a corresponding grace morphism g: Ψₙ → Ψₙ₋₁ such that g ∘ ψ preserves essential structure.</p>
                <p><strong>Foundation:</strong> This establishes the existence of stabilizing operators and provides the foundation for recursive identity preservation within stratified universe hierarchies.</p>
              </div>
              <div data-layperson="For every forward evolution of a system, there exists a 'grace' operation that can return it to its previous state while preserving what matters. Think of it like having an 'undo' button that works perfectly—no information is truly lost, and the system maintains its essential character.">
                <p><strong>Simple Explanation:</strong> For every forward evolution of a system, there exists a "grace" operation that can return it to its previous state while preserving what matters.</p>
                <p><strong>Analogy:</strong> Think of it like having an "undo" button that works perfectly—no information is truly lost, and the system maintains its essential character.</p>
              </div>
            </div>
          </div>

          <div class="axiom-item">
            <button class="axiom-header">
              <span data-technical="AG2 (Reflexivity): Yoneda embedding and internalization"><strong>AG2 (Reflexivity):</strong> Yoneda embedding and internalization</span>
              <span data-layperson="Self-Reference: Mathematics can examine and understand itself"><strong>Self-Reference:</strong> Mathematics can examine and understand itself</span>
            </button>
            <div class="axiom-content">
              <div data-technical="The grace operator G is reflexive: G(G(ψ)) = ψ for all morphisms ψ in the system. This creates the self-correcting property through Yoneda embedding that leads to the emergence of φ as the universal stability constant.">
                <p><strong>Statement:</strong> The grace operator G is reflexive: G(G(ψ)) = ψ for all morphisms ψ in the system.</p>
                <p><strong>Foundation:</strong> This creates the self-correcting property through Yoneda embedding that leads to the emergence of φ as the universal stability constant.</p>
              </div>
              <div data-layperson="Applying the stabilizing operation twice returns you to where you started. This prevents infinite loops and ensures mathematical stability—like a perfect self-correcting system that always finds its way back to balance.">
                <p><strong>Simple Explanation:</strong> Applying the stabilizing operation twice returns you to where you started. This prevents infinite loops and ensures mathematical stability.</p>
                <p><strong>Analogy:</strong> Like a perfect self-correcting system that always finds its way back to balance.</p>
              </div>
            </div>
          </div>

          <div class="axiom-item">
            <button class="axiom-header">
              <span data-technical="AG3 (Stabilization): Grace Operator existence and uniqueness"><strong>AG3 (Stabilization):</strong> Grace Operator existence and uniqueness</span>
              <span data-layperson="Stability: Nature chooses the most mathematically stable configurations"><strong>Stability:</strong> Nature chooses the most mathematically stable configurations</span>
            </button>
            <div class="axiom-content">
              <div data-technical="There exists a unique fixed point φ such that G(φ) = φ, and all recursive applications of G converge to this fixed point. This axiom guarantees the existence and uniqueness of the universal constant from which all physical parameters derive.">
                <p><strong>Statement:</strong> There exists a unique fixed point φ such that G(φ) = φ, and all recursive applications of G converge to this fixed point.</p>
                <p><strong>Foundation:</strong> This axiom guarantees the existence and uniqueness of the universal constant from which all physical parameters derive.</p>
              </div>
              <div data-layperson="The system has a natural 'attractor' state that everything eventually stabilizes toward. This attractor turns out to be the golden ratio φ—the most stable mathematical configuration possible.">
                <p><strong>Simple Explanation:</strong> The system has a natural "attractor" state that everything eventually stabilizes toward. This attractor turns out to be the golden ratio φ.</p>
                <p><strong>Analogy:</strong> Like water finding its level—no matter where you start, the system naturally flows toward the most stable mathematical configuration possible.</p>
              </div>
            </div>
          </div>

          <div class="axiom-item">
            <button class="axiom-header">
              <span data-technical="AG4 (Coherence): Fixed point category selection"><strong>AG4 (Coherence):</strong> Fixed point category selection</span>
              <span data-layperson="Consistency: All mathematical choices must work together harmoniously"><strong>Consistency:</strong> All mathematical choices must work together harmoniously</span>
            </button>
            <div class="axiom-content">
              <div data-technical="The grace operator preserves coherence: if ψ₁ and ψ₂ are coherent (mathematically compatible), then G(ψ₁) and G(ψ₂) remain coherent. This ensures that the mathematical structure remains consistent across all scales and applications through fixed point category selection.">
                <p><strong>Statement:</strong> The grace operator preserves coherence: if ψ₁ and ψ₂ are coherent (mathematically compatible), then G(ψ₁) and G(ψ₂) remain coherent.</p>
                <p><strong>Foundation:</strong> This ensures that the mathematical structure remains consistent across all scales and applications through fixed point category selection.</p>
              </div>
              <div data-layperson="The stabilizing process doesn't break the relationships between different parts of the system. Compatible states remain compatible—like a good conductor ensuring all musicians stay in harmony.">
                <p><strong>Simple Explanation:</strong> The stabilizing process doesn't break the relationships between different parts of the system. Compatible states remain compatible.</p>
                <p><strong>Analogy:</strong> Like a good conductor ensuring all musicians stay in harmony—individual parts may change, but they always work together beautifully.</p>
              </div>
            </div>
          </div>

          <div class="axiom-item">
            <button class="axiom-header">
              <span data-technical="AΨ1 (Identity): Recursive consciousness operator"><strong>AΨ1 (Identity):</strong> Recursive consciousness operator</span>
              <span data-layperson="Self-Awareness: The system can recognize and understand itself"><strong>Self-Awareness:</strong> The system can recognize and understand itself</span>
            </button>
            <div class="axiom-content">
              <div data-technical="Every mathematical object has a unique 'identity morphism' ψᵢ that maps it to itself, and these identity morphisms form a complete, self-referential system. This provides the basis for the recursive structure that generates the hierarchy of physical constants and laws.">
                <p><strong>Statement:</strong> Every mathematical object has a unique "identity morphism" ψᵢ that maps it to itself, and these identity morphisms form a complete, self-referential system.</p>
                <p><strong>Foundation:</strong> This provides the basis for the recursive structure that generates the hierarchy of physical constants and laws.</p>
              </div>
              <div data-layperson="Everything has a well-defined 'self' that can be mathematically characterized, and these 'selves' interact in predictable ways. It's like giving every part of mathematics a unique fingerprint that never changes.">
                <p><strong>Simple Explanation:</strong> Everything has a well-defined "self" that can be mathematically characterized, and these "selves" interact in predictable ways.</p>
                <p><strong>Analogy:</strong> It's like giving every part of mathematics a unique fingerprint that never changes—allowing the system to be completely self-aware and self-organizing.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="featured-gallery">
      <h2>Featured Figures</h2>
      <div id="featuredGrid" class="grid"></div>
    </section>

    <section class="article" id="article">
      <div class="articleLayout">
        <aside class="toc">
          <div class="card">
            <h3>Article Contents</h3>
            <ol class="toc-list">
              <li><a href="article.html#executive">Executive Summary</a>
                <ul class="toc-sub-list">
                  <li><a href="article.html#executive">FIRM Framework Overview</a></li>
                  <li><a href="article.html#executive">Key Achievements</a></li>
            </ul>
              </li>
              <li><a href="article.html#breakthroughs">Theoretical Foundation</a>
                <ul class="toc-sub-list">
                  <li><a href="article.html#breakthroughs">Five Foundational Axioms</a></li>
                  <li><a href="article.html#breakthroughs">Grace Operator Theory</a></li>
                  <li><a href="article.html#breakthroughs">φ-Recursive Patterns</a></li>
          </ul>
              </li>
              <li><a href="article.html#mathematical">Mathematical Development</a>
                <ul class="toc-sub-list">
                  <li><a href="article.html#mathematical">Differential Operators</a></li>
                  <li><a href="article.html#mathematical">Topological Framework</a></li>
                  <li><a href="article.html#mathematical">Category Theory</a></li>
          </ul>
              </li>
              <li><a href="article.html#constants">Physical Constants Analysis</a>
                <ul class="toc-sub-list">
                  <li><a href="article.html#constants">Fine Structure Constant</a></li>
                  <li><a href="article.html#constants">Mass Ratios</a></li>
                  <li><a href="article.html#constants">Coupling Constants</a></li>
            </ul>
              </li>
              <li><a href="article.html#applications">Applications & Extensions</a>
                <ul class="toc-sub-list">
                  <li><a href="article.html#applications">CMB Predictions</a></li>
                  <li><a href="article.html#applications">Neural Networks</a></li>
                  <li><a href="article.html#applications">Consciousness Models</a></li>
          </ul>
              </li>
              <li><a href="article.html#validation">Validation & Limitations</a>
                <ul class="toc-sub-list">
                  <li><a href="article.html#validation">Statistical Analysis</a></li>
                  <li><a href="article.html#validation">Error Assessment</a></li>
                  <li><a href="article.html#validation">Future Work</a></li>
          </ul>
              </li>
          </ol>
            <div class="toc-footer">
              <a href="article.html" class="cta secondary toc-button">Read Full Article →</a>
          </div>
          </div>
        </aside>

        <article>
          <h1>FIRM Theory: Mathematical Framework Overview</h1>
          <h2 id="abstract">Executive Summary</h2>
          <div class="insight">
            <p id="pAbs1">FIRM (Fractal Identity & Recursive Mechanics) proposes a mathematical framework for systematic derivation of fundamental physical constants through φ-recursive principles. The approach develops five foundational axioms and a Grace Operator whose fixed points generate recursive scaling patterns governed by the golden ratio <span class="phi">φ = (1+√5)/2</span>. Notable precision improvements are achieved, particularly for the fine structure constant, though the theoretical foundation requires continued development and independent validation.</p>
          </div>
          
          <div class="comparison">
            <strong>Key Development:</strong> The framework achieves 0.014% agreement with experimental values for the fine structure constant using the formulation α⁻¹ = 137 + φ⁻⁶, representing significant improvement over previous φ-based approaches. However, this precision should be evaluated considering systematic searches through φ-formulations and requires independent verification of theoretical foundations.
          </div>
          
          <div class="warning">
            <strong>Current Status:</strong> FIRM theory represents early-stage theoretical development with promising mathematical results that require broader physics community validation before scientific acceptance. The framework provides systematic mathematical tools for continued exploration in mathematical physics.
          </div>

          <div class="fig"><img id="fAbs1" alt="Conceptual overview" /><div class="caption">Overview of FIRM: from axioms through Grace operator to physical reality.</div><div class="actions"><a id="fAbs1Open" class="btn" target="_blank">open</a><a id="fAbs1Peer" class="btn" target="_blank">peer‑review</a></div></div>
          
          <div class="insight">
            <strong>Continue Reading:</strong> This overview provides a brief introduction to FIRM theory development. For comprehensive theoretical details, mathematical foundations, precision analysis, and validation frameworks, please read the full article.
          </div>
          
          <div class="article-cta">
            <a class="cta" href="article.html">Read the Complete FIRM Theory Article →</a>
          </div>

        </article>
      </div>
    </section>

  <script>
    const RAW_BASE = 'https://raw.githubusercontent.com/ktynski/FIRM-Fractal-Identity-Recursive-Mechanics/main/';

    async function headOrFallback(peer, canon){
      try { const r = await fetch(peer, { method: 'HEAD', cache: 'no-store' }); if (r.ok) return peer; } catch(e){}
      return canon;
    }
    function canonical(filename){ return RAW_BASE + 'figures/canonical_outputs/' + filename; }
    function arxiv(filename){ return RAW_BASE + 'arxiv_paper/FIRM_FINAL_SUBMISSION/figures/peer_review/' + filename; }

    function setFig(imgId, openId, peerId, filename){
      const url = canonical(filename);
      const img = document.getElementById(imgId);
      const open = document.getElementById(openId);
      const peer = document.getElementById(peerId);
      if (img) img.src = url;
      if (open) open.href = url;
      if (peer) headOrFallback(arxiv(filename), url).then(href => peer.href = href);
    }

    // Set up the conceptual overview figure
    document.addEventListener('DOMContentLoaded', function() {
      setFig('fAbs1','fAbs1Open','fAbs1Peer','conceptual_overview_diagram.png');
      
      // Gallery functionality
      const grid = document.getElementById('grid');
      const featuredGrid = document.getElementById('featuredGrid');
      const search = document.getElementById('search');
      const sort = document.getElementById('sort');
      const countBadge = document.getElementById('countBadge');
      const chips = document.getElementById('chips');
      const loadMoreBtn = document.getElementById('loadMore');
      const eliBtn = document.getElementById('eli25Toggle');
      const eli25Modal = document.getElementById('eli25Modal');
      const closeButton = document.querySelector('.close-button');

      // Check for saved ELI25 state
      const isELI25Active = localStorage.getItem('eli25Active') === 'true';
      console.log('ELI25 Debug - Initial state:', isELI25Active, 'Button found:', !!eliBtn);
      if (isELI25Active) {
        document.body.classList.add('eli25-active');
        if (eliBtn) eliBtn.textContent = 'Technical';
      }

      if (eliBtn) {
        eliBtn.addEventListener('click', () => {
          console.log('ELI25 Debug - Button clicked');
          // Toggle between modes
          const isCurrentlyActive = document.body.classList.contains('eli25-active');
          console.log('ELI25 Debug - Current state:', isCurrentlyActive);
          
          if (isCurrentlyActive) {
            // Switch to technical mode
            document.body.classList.remove('eli25-active');
            eliBtn.textContent = 'ELI25';
            localStorage.setItem('eli25Active', 'false');
            console.log('ELI25 Debug - Switched to technical mode');
          } else {
            // Switch to layperson mode
            document.body.classList.add('eli25-active');
            eliBtn.textContent = 'Technical';
            localStorage.setItem('eli25Active', 'true');
            console.log('ELI25 Debug - Switched to layperson mode');
          }
        });
      }

      // Keep modal functionality for explanation
      if (closeButton) {
        closeButton.addEventListener('click', () => {
          eli25Modal.style.display = 'none';
        });
      }

      window.addEventListener('click', (event) => {
        if (event.target == eli25Modal) {
          eli25Modal.style.display = 'none';
        }
      });

      let allFigures = [];
      let visible = 0;
      const PAGE = 40;

      const FEATURED = [
        'fine_structure_constant_derivation.png'
      ];

      async function loadManifest() {
        try {
          const res = await fetch(RAW_BASE + 'figures/peer_review/figure_manifest.json', { cache: 'no-store' });
          if (res.ok) return res.json();
        } catch (e) {}
        return { figures: [] };
      }

      function inferTags(f) {
        const s = (f.filename || '').toLowerCase();
        const tags = [];
        if (s.includes('category') || s.includes('topos')) tags.push('category');
        if (s.includes('geometry') || s.includes('riemann') || s.includes('manifold') || s.includes('curvature')) tags.push('geometry');
        if (s.includes('pde') || s.includes('elliptic') || s.includes('heat') || s.includes('schauder')) tags.push('pde');
        if (s.includes('prob') || s.includes('stochastic') || s.includes('random') || s.includes('clt') || s.includes('lln')) tags.push('probability');
        if (s.includes('topology') || s.includes('homology') || s.includes('cohomology') || s.includes('spectral_sequence')) tags.push('topology');
        return tags;
      }

      const activeTags = new Set();
      let tagCounts = {};

      function computeTagCounts() {
        tagCounts = {};
        for (const f of allFigures) {
          for (const t of inferTags(f)) {
            tagCounts[t] = (tagCounts[t] || 0) + 1;
          }
        }
      }

      function renderChips() {
        computeTagCounts();
        if (!chips) return;
        chips.innerHTML = '';
        const tagsSorted = Object.keys(tagCounts).sort((a,b)=> (tagCounts[b]-tagCounts[a]));
        for (const t of tagsSorted) {
          const count = tagCounts[t];
          if (!count) continue;
          const el = document.createElement('div');
          el.className = 'chip' + (activeTags.has(t) ? ' active' : '');
          el.textContent = `${t} (${count})`;
          el.onclick = () => { if (activeTags.has(t)) activeTags.delete(t); else activeTags.add(t); resetAndRender(); };
          chips.appendChild(el);
        }
      }

      function filteredSorted() {
        let q = (search.value || '').toLowerCase().trim();
        let arr = allFigures;
        if (q) {
          arr = allFigures.filter(f => f.filename.toLowerCase().includes(q));
        }
        
        if (activeTags.size) {
          arr = arr.filter(f => {
            const ts = inferTags(f);
            return ts.some(tag => activeTags.has(tag));
          });
        }
        const mode = sort.value;
        if (mode === 'width') arr.sort((a,b)=> (b.width||0)-(a.width||0));
        else if (mode === 'height') arr.sort((a,b)=> (b.height||0)-(a.height||0));
        else arr.sort((a,b)=> (a.filename||'').localeCompare(b.filename||''));
        return arr;
      }

      function resetAndRender() {
        visible = 0;
        if(grid) grid.innerHTML = '';
        renderChips();
        const arr = filteredSorted();
        if(countBadge) countBadge.textContent = arr.length;
        appendMore(arr);
      }

      function appendMore(arr) {
        const next = arr.slice(visible, visible + PAGE);
        visible += next.length;
        if(grid) {
          for (const f of next) grid.appendChild(tileFor(f));
        }
        if(loadMoreBtn) {
          loadMoreBtn.style.display = (visible < arr.length) ? 'block' : 'none';
          loadMoreBtn.onclick = () => appendMore(arr);
        }
      }

      function tileFor(f) {
        const tile = document.createElement('div');
        tile.className = 'tile';
          const img = document.createElement('img'); 
          img.loading = 'lazy'; 
          img.decoding = 'async'; 
          img.src = canonical(f.filename); 
          img.alt = f.filename;
          
          const meta = document.createElement('div'); 
          meta.className = 'meta';
          
          const name = document.createElement('div'); 
          name.className = 'name'; 
          name.textContent = f.filename;

          const tagsContainer = document.createElement('div');
          tagsContainer.className = 'tags';
          const tags = inferTags(f);
          for (const t of tags) {
            const tagEl = document.createElement('span');
            tagEl.className = 'tag';
            tagEl.textContent = t;
            tagsContainer.appendChild(tagEl);
          }
          
          const actions = document.createElement('div'); 
          actions.className = 'actions';
          
          const openBtn = document.createElement('a'); 
          openBtn.className = 'btn'; 
          openBtn.href = canonical(f.filename); 
          openBtn.target = '_blank'; 
          openBtn.textContent = 'open';
          
          actions.appendChild(openBtn);
          meta.appendChild(name);
          meta.appendChild(tagsContainer);
          meta.appendChild(actions);
          tile.appendChild(img);
          tile.appendChild(meta);
          
          return tile;
        }

        // Populate featured grid
        if (featuredGrid) {
          for (const f of FEATURED) {
            featuredGrid.appendChild(tileFor({ filename: f }));
          }
        }

        // Load the gallery data
        loadManifest().then(data => {
        allFigures = data.figures || [];
        resetAndRender();
          if (search) search.addEventListener('input', resetAndRender);
          if (sort) sort.addEventListener('change', resetAndRender);
        });

        const hamburgerMenu = document.querySelector('.hamburger-menu');
        const nav = document.querySelector('.nav');
        if (hamburgerMenu && nav) {
          hamburgerMenu.addEventListener('click', () => {
            nav.classList.toggle('active');
          });
          
          // Close menu when clicking outside
          document.addEventListener('click', (event) => {
            if (!hamburgerMenu.contains(event.target) && !nav.contains(event.target)) {
              nav.classList.remove('active');
            }
          });
        }

        // Homepage axiom accordion functionality
        const axiomItems = document.querySelectorAll('.axiom-item');
        axiomItems.forEach(item => {
          const header = item.querySelector('.axiom-header');
          if (header) {
            header.addEventListener('click', () => {
              item.classList.toggle('active');
              const content = item.querySelector('.axiom-content');
              
              if (content.style.maxHeight) {
                content.style.maxHeight = null;
              } else {
                content.style.maxHeight = content.scrollHeight + 'px';
              }
            });
          }
        });

        const backToTopButton = document.getElementById('backToTop');
        window.onscroll = function() {
          if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
            if (backToTopButton) backToTopButton.style.display = 'block';
          } else {
            if (backToTopButton) backToTopButton.style.display = 'none';
          }
        };
        if (backToTopButton) {
          backToTopButton.onclick = function() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
          };
        }
    });
  </script>

    <!-- Gallery Section -->
    <section class="section" id="gallery">
      <h2>Figure Gallery</h2>
      <div class="controls">
        <div class="toolbar">
          <input class="search" id="search" placeholder="Search figure names…" />
          <select class="select" id="sort">
            <option value="name">Sort: Name</option>
            <option value="width">Sort: Width</option>
            <option value="height">Sort: Height</option>
          </select>
          <span class="badge" id="countBadge">Loading...</span>
        </div>
      </div>
      <div class="filterchips" id="chips"></div>
      <div id="grid" class="grid"></div>
      <button class="btn loadmore" id="loadMore">Load More</button>
    </section>
    
    <section class="section">
      <div class="card">
        <h3>Reproduce it yourself</h3>
        <p class="subtle">Everything here is generated from code. Clone the repo and run the peer‑review sync to rebuild the canonical set and arXiv copies:</p>
        <pre class="subtle code-block">python figures/peer_review/sync_and_verify.py --generate-math
python figures/peer_review/sync_and_verify.py --prepare-submission</pre>
        <p class="subtle">Outputs: <code>figures/canonical_outputs/</code> (single source of truth) and <code>arxiv_paper/FIRM_FINAL_SUBMISSION/figures/peer_review/</code> (submission‑ready).</p>
      </div>
    </section>
    
    <section class="footer">
      <div>© Ex Nihilo Reality — All figures generated from code; see repository for provenance.</div>
    </section>
  </main>
  <button id="backToTop" class="back-to-top" title="Go to top">↑</button>
</body>
</html>
